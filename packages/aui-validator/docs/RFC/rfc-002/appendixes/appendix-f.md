Appendix F — Canonical Artifact Lifecycle (Canonical)
F.1 Purpose {#f1}
Appendix F defines the full lifecycle of an AUI artifact as it moves through the AUI Studio pipeline ([Canonical Artifact](../../glossary/aui-glossary.md#canonical-artifact) lifecycle).
It establishes:
- the [canonical artifact](../../glossary/aui-glossary.md#canonical-artifact) types
- the allowed transformations
- the [invariants](../../glossary/aui-glossary.md#semantic-invariant) preserved across stages
- the responsibilities of each subsystem
- the boundaries between semantic, structural, and [renderer](../../glossary/aui-glossary.md#renderer)‑specific layers
This appendix is normative.

F.2 Artifact Types {#f2}
The AUI pipeline produces and consumes the following canonical artifacts:
|  |  |  | 
|  | artifact.raw.aui ([Raw Artifact](../../glossary/aui-glossary.md#raw-artifact)) |  | 
|  | artifact.validated.aui ([Validated Artifact](../../glossary/aui-glossary.md#validated-artifact)) ([Validated Artifact](../../glossary/aui-glossary.md#validated-artifact)) |  | 
|  | artifact.aui ([Canonical Artifact](../../glossary/aui-glossary.md#canonical-artifact)) |  | 
|  | artifact.render.json |  | 
|  | artifact.host.ui |  | 


Each artifact MUST be:
- deterministic
- JSON‑serializable
- free of executable code
- free of renderer‑specific semantics (until stage 4)

F.3 Stage 1 — Raw Artifact Generation {#f3}
Generated by:
- [Wisk](../../glossary/aui-glossary.md#wisk) ([intent](../../glossary/aui-glossary.md#intent-layer) engine)
- AI models
- developer tools
Properties:
- may contain [template constructs](../../glossary/aui-glossary.md#template-constructs)
- may contain unresolved bindings
- may contain semantic or structural errors
- may contain natural language
The raw artifact MUST NOT be used for rendering.

F.4 Stage 2 — Validation {#f4}
The [validator](../../glossary/aui-glossary.md#validator) transforms:
artifact.raw.aui → artifact.validated.aui


Validator responsibilities (summarized from Appendix C):
- enforce [grammar](../../glossary/aui-glossary.md#grammar)
- enforce semantics
- enforce component contracts
- enforce layout rules
- enforce cross‑node invariants
- normalize structure
The validator MUST NOT:
- infer missing semantics
- rewrite meaning
- introduce renderer‑specific constructs

F.5 Stage 3 — Canonicalization {#f5}
The canonicalizer transforms:
artifact.validated.aui → artifact.aui


Canonicalization includes:
- stable key ordering
- removal of unused metadata
- normalization of empty structures
- deterministic formatting
- stable node ordering
Canonicalization MUST NOT:
- change semantics
- introduce new fields
- remove required fields
The [canonical artifact](../../glossary/aui-glossary.md#canonical-artifact) is the authoritative representation of UI semantics.

F.6 Stage 4 — Renderer Preparation {#f6}
[Renderer adapters](../../glossary/aui-glossary.md#renderer-adapter) transform:
artifact.aui → artifact.render.json


Renderer preparation includes:
- mapping [semantic](../../glossary/aui-glossary.md#semantic-family) [kinds](../../glossary/aui-glossary.md#kind) → platform primitives
- mapping semantic [props](../../glossary/aui-glossary.md#props) → platform props
- expanding composite [components](../../glossary/aui-glossary.md#component)
- resolving [parts](../../glossary/aui-glossary.md#parts)
- applying renderer defaults
- preparing event references
Renderer preparation MUST NOT:
- reinterpret semantics
- reorder children
- infer layout
- execute event handlers

F.7 Stage 5 — Host Integration {#f7}
The host environment transforms:
artifact.render.json → artifact.host.ui


Host responsibilities:
- instantiate platform UI [components](../../glossary/aui-glossary.md#component)
- attach [event handlers](../../glossary/aui-glossary.md#event-handler)
- bind [data contexts](../../glossary/aui-glossary.md#data-context)
- apply platform‑specific constraints
Host MUST NOT:
- mutate semantic meaning
- reinterpret AUI semantics
- introduce nondeterminism

F.8 Invariant Preservation {#f8}
Across all stages, the following invariants MUST hold:
F.8.1 Structural Invariants {#f81}
- [tree](../../glossary/aui-glossary.md#tree) shape preserved
- [node](../../glossary/aui-glossary.md#node) ordering preserved
- no cycles introduced
F.8.2 [Semantic Invariants](../../glossary/aui-glossary.md#semantic-invariant) {#f82}
- [kind](../../glossary/aui-glossary.md#kind) semantics preserved
- [props](../../glossary/aui-glossary.md#props) semantics preserved
- [layout](../../glossary/aui-glossary.md#layout) semantics preserved
- [contract](../../glossary/aui-glossary.md#component-contract) semantics preserved
F.8.3 [Binding](../../glossary/aui-glossary.md#binding) Invariants {#f83}
- [binding paths](../../glossary/aui-glossary.md#binding-path) preserved
- no new bindings introduced
- no binding expressions introduced
F.8.4 [Determinism](../../glossary/aui-glossary.md#determinism) Invariants {#f84}
- identical input → identical output
- stable normalization
- stable renderer mapping

F.9 Transformation Legality Matrix {#f9}
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 
|  |  |  | 



F.10 Error Propagation Model {#f10}
Errors MUST be raised at the earliest responsible stage.
- structural errors → validator
- semantic errors → validator
- contract errors → validator
- layout errors → validator
- renderer mapping errors → renderer
- platform errors → host
Errors MUST NOT be silently swallowed.

F.11 Versioning Rules {#f11}
Each artifact MUST declare:
- AUI version
- contract version
- renderer adapter version
Version mismatches MUST cause:
- validator rejection
- renderer rejection
- host rejection

F.12 Compliance Requirements {#f12}
A pipeline is compliant if:
- each stage preserves invariants
- each stage performs only its allowed transformations
- each artifact type is produced correctly
- determinism is preserved end‑to‑end
Compliance MUST be testable via:
- golden artifacts
- structural diffs
- semantic diffing
- renderer snapshot tests
